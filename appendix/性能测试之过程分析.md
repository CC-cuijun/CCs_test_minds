# 性能测试之过程分析

## 性能测试和功能测试的区别
- 环境一致性（与线上环境）
  - 硬件
  - 软件
    - 版本
    - 配置
  - 场景
    - 数据模型
    - 使用模式
- 策略
  - 通过建模的方式实现对生产环境的业务模拟
  - 通过平行扩展能力(集群)预估线网性能
  - 关注系统整体表现
  
## 怎样才能做好性能测试
- 掌握一门语言/性能测试框架
- 掌握常见的性能测试方法
- 掌握常见的性能分析方法
- 掌握丰富的技术（计算机网络、操作系统、计算机原理、数据库、抓包等）

## 性能测试过程

### 性能测试需求分析
- 分析性能需求
- 明确测试目的
- 明确测试范围

### 测试策略制定
- 需要做哪些测试（测试点梳理）
- 需要准备什么数据（业务数据和脚本数据）
- 需要监控哪些指标（以及如何监控）
- 制定测试实施计划

### 测试环境的选择/准备
- 确认性能测试环境
  - 日常测试环境
  - 独立部署环境
  - 生产环境打标（全链路测试）
  - 全新生产环境
- 指标监控方案
  - 指标采集方式确认
  - 客户端监控
- 压测客户端
  - 客户端部署
  - 测试数据隔离
  - 测试依赖服务部署（测试依赖的jdk，nodejs，redis等等）

### 测试开发

#### 测试工具开发
- 一些特殊场景需要依赖一些测试工具的开发，根据实际情况进行框架及语言选择；
- 开源工具框架为了适应特殊场景需要修改或二次开发，根据实际情况进行分析及开发；
#### 测试脚本开发
- 测试脚本的开发主要基于测试场景进行业务模拟，并根据线上业务场景的分析编写合理的测试脚本，更真实的模拟线上实际业务。
- 针对未上线的业务场景，一般情况下为找到新业务的TPS而编写合理的测试脚本，目的为上线前做好业务服务能力摸底及服务节点准备。
#### 测试数据准备
- 根据场景构造测试业务数据（服务依赖的数据，需做好数据隔离）
- 根据脚本及业务数据准备测试数据（客户端需使用的数据）

### 压测场景用例构建
- 用户角度
	- 响应时间
	- 业务稳定性
	- 并发量
	- 错误率
- 开发角度
	- 架构是否合理
	- 数据库设计
	- 代码实现（算法）
	- 内存
	- 线程/队列
- 管理员
	- 系统资源开销
	- 系统平行扩展能力
	- 系统容量
	- 稳定性
- 场景设计法（性能测试主要采用该方法）

### 压测执行

#### 关键指标采集
- 业务关键指标（主要）
  - 响应时间
  - 吞吐量
  - TPS/QPS（思考时间thinktime对QPS有影响）
  - 并发数
- 资源利用率（主要）
  - cpu
  - 内存
  - 磁盘IO
  - 网卡流量
### 性能测试结果分析

### 性能调优
- 硬件（服务器物理机配置及状态等）
- 软件
  - 平台/容器（依赖的中间件服务，容器的使用方式等）
  - 程序（业务代码逻辑等）
- 系统（系统优化）
- 网络（对带宽的依赖等）

### 总结报告及归档
- 测试目标及范围、策略
- 服务器资源说明（环境）
- 业务模拟（测试规则）
- 结果图表等（测试结果）
- 调优过程（问题及如何解决，进行了哪些优化）
- 有量化的指标（TPS、并发、容量、扩展能力）  

目的：写明测试目的，测试的各种条件及情况，测试结果，以及针对测试结果分析性能情况，是否满足需求，并提出优化建议或部署建议等，总结测试过程，优化以后的测试。

## jmeter压测过程源码分析

